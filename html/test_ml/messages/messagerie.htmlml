<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="messages.css" />
  <title>Document</title>
</head>
<body>
  <h1>Message Test</h1>
  <div id="applicationFrame">
    <div id="messages">
      <{
        let db = Sqlite.opendb "messagerie.db"
      }>
      <{
        Sqlite.exec db (fun acc -> fun new_line -> <[ <{acc}> <{new_line}> ]>)
          (
            fun acc -> fun hd -> fun content ->
            <[
              <{ acc }>
              <{
                if hd = "pseudo" then begin
                  if content = Session.pseudo then
                    <[ <div class="myMessage"><i class="pseudo"><{content}></i><br/> ]>
                  else
                    <[ <div class="otherMessage"><i class="pseudo"><{content}></i><br/> ]>
                end else if hd = "data" then begin
                  <[ <{content}> </div> ]>
                end else <[]>
              }>
            ]>
          )
          "SELECT * FROM Message"
      }>
      <{
        let x = Sqlite.closedb db
      }>
    </div>
    <div id="messageInput">
      <form method="POST" action="./message.htmlml">
        <input type="text" id="messageBox" name="contenue">
        <input type="submit" id="sendButton" name="Envoyer" value="Envoyer">
      </form>
      <a id="resetButton" href="reset_messages.htmlml">RÃ©initialiser</a>
    </div>
  </div>
</body>
</html>